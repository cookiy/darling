<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link href="stylesheets/side_style.css" rel="stylesheet" type="text/css" />
    <link href="stylesheets/hi_colorA.css" rel="stylesheet" type="text/css"  />
    <link href="stylesheets/share.css" rel="stylesheet" type="text/css" />
    <link href="stylesheets/message.css" rel="stylesheet" type="text/css" />
    <script src="javascripts/JQLib/jquery-1.7.2.min.js" type="text/javascript"></script>
</head>
<body class="scheduleBody">
    <div class="addressBook" style="overflow:auto;height:100%">
      <h4 class="conTop orgStrIco"><a href="#" class="icons"></a>短信</h4>
      <div class="titTop">
        <ul class="sms">
          <li class="one"><a href="/sendmsg">发短信</a></li>
          <li class="two"><a href="#" class="hover">短信记录</a></li>
          <li class="three"><a href="/userlist">联系人</a></li>
        </ul>
        <div class="clear"></div>
      </div>
      <!--smsBox begin  -->
      <div id="contain" class="smsBox" style="overflow:auto;height:80%">

      </div>
      <!--smsBox end-->
  <div class="clearer"></div>

   <div class="tips" style="display:none;border:1px solid red;" id="smsNameUlli1a">
    <div class="tipsBox"> <em class="tip" style="left: 92px;"></em>
    <table cellpadding="0" cellspacing="0" border="0" class="shareTable">
        <tr>
        <th>姓名:</th>
        <td>陆小七</td>
        </tr>
        <tr>
        <th>手机:</th>
        <td>13581801093</td>
        </tr>
        <tr>
        <th>单位:</th>
        <td>安博</td>
        </tr>
        <tr>
        <th>职称:</th>
        <td>设计师</td>
        </tr>
        <tr>
        <th>回复内容:</th>
        <td>你这个设计做的不错~再接再厉！</td>
        </tr>
    </table>
    </div>
</div>
</div>
</body>
</html>
<script type="text/javascript">
    var objarr = [{ id: "msgid", title: "教育司办公室祝各位领导及同事教师节快乐！", date: "2012-8-1 12:20", failMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], SuccessMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], ReplyMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"] }, { id: "msgid", title: "教育司办公室祝各位领导及同事教师节快乐！", date: "2012-8-1 12:20", failMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], SuccessMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], ReplyMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"] }, { id: "msgid", title: "教育司办公室祝各位领导及同事教师节快乐！", date: "2012-8-1 12:20", failMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], SuccessMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], ReplyMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"] }, { id: "msgid", title: "教育司办公室祝各位领导及同事教师节快乐！", date: "2012-8-1 12:20", failMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], SuccessMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], ReplyMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"] }, { id: "msgid", title: "教育司办公室祝各位领导及同事教师节快乐！", date: "2012-8-1 12:20", failMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], SuccessMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"], ReplyMsg: ["陆小七15210183488_uid", "陆小七15210183488_uid", "陆小七15210183488_uid"]}];

    var html = "";
    for (var i = 0; i < objarr.length; i++) {
        html += "<dl class='smsRecord'>";
        html += "<dt>";
        html += "<p class='title'>发送内容：" + objarr[i].title + "</p>";
        html += "<p class='time'>发送时间：" + objarr[i].date + "</p>";
        html += "</dt>";
        /*************************** 失败信息 begin*************************************/
        html += "<dd>"
        html += "<i class='color_green'>失败信息 </i>";
        html += "<input type='checkbox' seltag='" + objarr[i].id + "' onclick='selectall(this);'/>全选";
        html += "<div class='pad'></div>";
        html += "<div class='clearer'></div>";
        for (var j = 0; j < objarr[i].failMsg.length; j++) {
            html += "<span>";
            html += "<input type='checkbox' name='" + objarr[i].id + "' />&nbsp";
            html += "<i msgid='" + objarr[i].id + "' uid='" + objarr[i].failMsg[j].split('_')[1] + "' onmousemove='mousemove(this,event);' onmouseout='mouseout(this,event);'>" + objarr[i].failMsg[j].split('_')[0] + "</i>";
            html += "</span>";
        }
        html += "<a href='#' class='del' onclick='deletesel(this);'>删除</a>";
        html += "</dd>";
        /*************************** 失败信息 end***************************************/

        /*************************** 成功信息 begin*************************************/
        html += "<dd>";
        html += "<i class='color_green'>成功信息 </i>";
        html += "<input type='checkbox' onclick='selectall(this);'/>全选";
        html += "<div class='pad'></div>";
        html += "<div class='clearer'></div>";
        for (var j = 0; j < objarr[i].SuccessMsg.length; j++) {
            html += "<span>";
            html += "<input type='checkbox' name='" + objarr[i].id + "' />&nbsp";
            html += "<i msgid='" + objarr[i].id + "' uid='" + objarr[i].SuccessMsg[j].split('_')[1] + "' onmousemove='mousemove(this,event);' onmouseout='mouseout(this,event);'>" + objarr[i].SuccessMsg[j].split('_')[0] + "</i>";
            html += "</span>";
        }
        html += "<a href='#' class='del' onclick='deletesel(this);'>删除</a>";
        html += "</dd>";
        /*************************** 成功信息 end***************************************/

        /*************************** 回复信息 begin*************************************/
        html += "<dd>"
        html += "<i class='color_green'>回复信息 </i>";
        html += "<input type='checkbox' onclick='selectall(this);'/>全选";
        html += "<div class='pad'></div>";
        html += "<div class='clearer'></div>";
        for (var j = 0; j < objarr[i].ReplyMsg.length; j++) {
            html += "<span>";
            html += "<input type='checkbox' name='" + objarr[i].id + "' />&nbsp";
            html += "<i msgid='" + objarr[i].id + "' uid='" + objarr[i].ReplyMsg[j].split('_')[1] + "' onmousemove='mousemove(this,event);' onmouseout='mouseout(this,event);'>" + objarr[i].ReplyMsg[j].split('_')[0] + "</i>";
            html += "</span>";
        }
        html += "<a href='#' class='del' onclick='deletesel(this);'>删除</a>";
        html += "</dd>";
        /*************************** 回复信息 end*************************************/

        html += "</dl>";
    }

    $("#contain").append($(html));

    //全选
    function selectall(obj) {
        var selarr = new Array();
        $(obj).parent().children("span").each(function () {
            selarr.push($(this).children("input[type=checkbox]"));
        })
        if (obj.checked == true) {
            for (var i = 0; i < selarr.length; i++) {
                $(selarr[i]).get(0).checked = true;
            }
        }
        else {
            for (var i = 0; i < selarr.length; i++) {
                $(selarr[i]).get(0).checked = false;
            }
        }
    }

    //删除
    function deletesel(obj) {
        var selarr = new Array();
        var delids = new Array();
        var count = 0;
        $(obj).parent().children("span").each(function () {
            selarr.push($(this).children("input[type=checkbox]"));
        })
        for(var i = 0; i < selarr.length; i++){
            if ($(selarr[i]).get(0).checked){
                count++;
            }
        }
        if(count ==0)
        {
            alert("请至少选择一项!");
            return;
        }
        if (window.confirm("请确认是否删除?")) {
            for (var i = 0; i < selarr.length; i++) {
                if ($(selarr[i]).get(0).checked) {
                    //记录下uid and msgid   uid_msgid
                    delids.push($(selarr[i]).next().attr("uid") + "_" + $(selarr[i]).next().attr("msgid"));
                    $(selarr[i]).parent().remove();
                }
            }
        }

    }

    //mousemove,mouseout事件
    function mousemove(obj, e) {
        $("#smsNameUlli1a").css("display", "block");
        var posx = e.pageX;
        var posy = e.pageY;
        $("#smsNameUlli1a").css("top", posy + 20);
        $("#smsNameUlli1a").css("left", posx + 20);
    }

    function mouseout(obj, e) {
        $("#smsNameUlli1a").css("display", "none");
    }
</script>